# DEV.md

## 目标
做一个节奏清晰、可快速对局、可验证“好玩循环”的卡牌 Demo2：每回合抽 5 选 3 排序，同时翻开，顺序对冲 3 次，累计结算。

## 基础规则（固定牌组）
- 每位玩家一副牌：15 张（A×5 / D×5 / R×5）
- 初始血量：10（无上限，最低可降到 0）
- 总回合数：10 回合
- 结束条件：任意一方血量 ≤ 0 立即结束；否则第 10 回合结束后比较血量，高者胜，平局即平局

## 对冲结算（单次 1v1）
说明：表内为“我方变化 / 对方变化”。三次对冲逐次结算并累计到本回合。

| 我方 \ 对方 | 进攻 A | 防守 D | 休养 R |
| --- | --- | --- | --- |
| 进攻 A | 双方 -2 | A 0 / D 0 | A 0 / R -2 |
| 防守 D | D 0 / A 0 | 双方 0 | D 0 / R +1 |
| 休养 R | R -2 / A 0 | R +1 / D 0 | 双方 +1 |

## 回合流程（双方同时）
1. 抽牌：从牌库抽 5 张，作为“本回合可选牌”。
2. 选牌：从 5 张中选择 3 张。
3. 排序：将 3 张按第 1/2/3 顺序排列。
4. 同时揭示：双方同时翻开 3 张序列。
5. 三次对冲：按 1vs1、2vs2、3vs3 依次结算。
6. 弃置：本回合抽到的 5 张（含未选 2 张）全部进入弃牌堆。
7. 进入下一回合。

## 牌库不足 5 张处理
- 抽牌时若牌库不足 5：先抽完剩余，再将弃牌堆洗回牌库继续抽到 5。
- 若弃牌堆为空，则按实际数量抽（允许本回合少于 5 张）。

## 页面与交互（前端 UI）
### 单回合界面需求
- 清晰展示：当前回合数、双方血量。
- 本回合抽到的 5 张（仅显示 A/D/R 图标即可）。
- 已选区（3 张）+ 拖拽排序（1/2/3）。
- 出牌按钮：点击后锁定本回合选择并进入等待。
- 同时揭示：展示双方 3 张序列。
- 三次对冲动画/分步展示：逐次显示本次对冲的血量变化。

### 回合结算与结束
- 每回合结算后刷新血条与回合数。
- 若达到结束条件，展示结果（胜/负/平）与结束原因（血量归零 / 10 回合结束）。

## 对战模式
- 支持：玩家 vs 简单 AI（优先）或 玩家 vs 玩家（二选一均可）。
- 简单 AI：从 5 张中随机选 3 张，随机排序。

## 数据与状态（前端建议）
- 玩家状态：`hp`、`deck`、`discard`、`hand(5)`、`selected(3)`、`ordered(3)`。
- 回合状态：`round`、`phase(draw/select/reveal/resolve/end)`。
- 结算展示：记录三次对冲的结果（每次的牌型与血量变化）。

## 验收清单（Demo2 Done）
- 可开始一局对战（P vs AI / P vs P 二选一均可）。
- 每回合完成：抽 5 → 选 3 → 排序 → 同时揭示。
- 按顺序完成 3 次对冲，血量变化正确累计。
- 10 回合结束或任意一方血量 ≤ 0 时可正确判定胜负。
- 牌库不足 5 张时能洗回弃牌堆继续抽牌。
- UI 至少清晰展示：回合数、双方血量、双方 3 张顺序、每次对冲结果。
